# flake8: noqa
from agent_service.utils.prompt_utils import Prompt

CREATE_STOCK_GROUPS_DESCRIPTION = "This tool takes a table with data stocks, and groups those stocks according to a provided definition using the data in the table. The input table must include data only for the stocks that the client wishes to group, and all the information needed to group the stocks must be included in the table. In order to do this properly, the input table must NOT be a time series, and there must be exactly one row corresponding to each stock. The definition should explain the grouping in plain English, starting with the following phrase 'group the stocks according to...'. If you are interested in just grouping by all the unique values of the table, you can just specific that column (e.g. `sector`), otherwise, if the client clearly wishes to group using some numerical value, you should specify the range for each group in your definition, e.g. `group the stocks according to weekly stock price percent gain based on the following breakdown: <-5; -5--0, 0--5, > 5. If the client does not specify a reasonable breakdown for a numerical column (like market cap) you must always create one that will sensibly cover the range. Look elsewhere in your instructions for a potential reasonable breakdown, for instance you have been provided with a definition of sensible ranges for market cap, but if none exists just try to create groupings that will cover the range well. You may also break down by multiple columns of the table (e.g. group both by performance and market cap), just include both columns and any relevant numerical breakdowns; make sure you always include a breakdown if any one of the column is numerical even if others aren't! For instance, if the user asks for breakdown by both sector and market cap, you must include a numerical breakdown for market cap in your definition, e.g. `group the stocks based on sector as well as market cap with the following breakdown: ...`. If you do not provide a breakdown for every numerical column, your grouping will fail and you will be fired. It is okay if your definition is fairly long, just include it all on one line. The header should be a word or short phrase that can serve as a column header when when the groups are presented in a table. For example for sectors a good label is `Sector`, for stocks broken down by market cap, `Market Cap Range`, if there are multiple breakdowns use conjunctions in your label. The ouput of this tool is StockGroups which can be passed as a unit to releven (per group) tools to do parallelized/vectorizes operations over the groups all at once. If you are working with just two groups, you may simply call the relevant tools twice, but for 3 or more groups you must always use this tool rather than manually breaking down the groups in separate calls to transform table."

CREATE_GROUP_MAIN_PROMPT_STR = "You are a financial analyst, you have been given a table of data about some stocks and some instructions about how to group the stocks in that table (each row corresponds to one stock). Your task is simple: given a set of column labels and the free-form text input, convert the information into a JSON for processing. Your JSON output should be a list where each item corresponds to one column of data that is needed for the grouping (mentioned explicitly), in the vast majority of cases the list will have a single item, though if the description mentions more than once column you should follow the instructions below for each. Never include a stock/security column in your list. The elements of the list will be mappings with one required argument (column) and one optional argument (thresholds). column must be a string corresponding exactly to one of the provide column labels; if the user mentioned something that can be reasonable understood as refering to one of the provided columns, use it. Never output the client's wording unless it is an exact match. If the instructions suggest that the user just wants a separate group for each unique value of the column (e.g. sectors), then you will leave the thresholds key out entirely. Otherwise, thresholds should be a list of integers or floats which divides the possible values of the numerical column into buckets. Thresholds must be in order from smallest to largest. For example, if the client asked for grouping by weekly price change according to the following breakdown:  <-5; -5--0, 0--5, > 5, you would translate that into a list of three thresholds: [-5, 0, 5]. If the client leaves out a category, you can assume it, just make sure that you make use of all the numbers mentioned in the instructions when creating your list of thresholds. If no numbers are mentioned, you can assume that no numerical breakdown is required, and you will then exclude the thresholds key entirely. You must output only this list of mappings, do not output anything else. Here are the labels of the column: {labels}. And here are your instructions grouping that you need to convert to json format: {definition}. Now output the JSON:\n"

CREATE_GROUP_MAIN_PROMPT = Prompt(CREATE_GROUP_MAIN_PROMPT_STR, "CREATE_GROUP_MAIN_PROMPT")
